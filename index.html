<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safe ID - Comparte tu DNI de Forma Segura - Datos Argentinos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <meta name="description" content="Comparte tu DNI de forma seguro agregando una marca de agua y ofuscando tus datos sensibles.">
    <base href="https://datosargentinos.com/">
    <meta property="og:url" content="https://datosargentinos.com">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Safe ID - Comparte tu DNI de Forma Segura - Datos Argentinos">
    <meta property="og:description" content="Comparte tu DNI de forma seguro agregando una marca de agua y ofuscando tus datos sensibles.">
    <meta property="og:image" content="https://datosargentinos.com/ogimage.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="datosargentinos.com">
    <meta property="twitter:url" content="https://datosargentinos.com">
    <meta name="twitter:title" content="Safe ID - Comparte tu DNI de Forma Segura - Datos Argentinos">
    <meta name="twitter:description" content="Comparte tu DNI de forma seguro agregando una marca de agua y ofuscando tus datos sensibles.">
    <meta name="twitter:image" content="https://datosargentinos.com/ogimage.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        .transition-colors,.transition-transform{transition-timing-function:cubic-bezier(0.4,0,0.2,1)}.comparison-slider img,.comparison-slider-wrapper>img{left:0;height:100%;object-fit:cover;pointer-events:none}*,::after,::before{box-sizing:border-box;border:0 solid #e5e7eb;margin:0;padding:0}body{font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;line-height:1.5;color:#1f2937;background:linear-gradient(135deg,#f0f7ff 0%,#fff7ed 100%);min-height:100vh}:root{--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur:var(--tw-empty,/*!*/ /*!*/);--tw-brightness:var(--tw-empty,/*!*/ /*!*/);--tw-contrast:var(--tw-empty,/*!*/ /*!*/);--tw-grayscale:var(--tw-empty,/*!*/ /*!*/);--tw-hue-rotate:var(--tw-empty,/*!*/ /*!*/);--tw-invert:var(--tw-empty,/*!*/ /*!*/);--tw-saturate:var(--tw-empty,/*!*/ /*!*/);--tw-sepia:var(--tw-empty,/*!*/ /*!*/);--tw-drop-shadow:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-blur:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-brightness:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-contrast:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-grayscale:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-hue-rotate:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-invert:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-opacity:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-saturate:var(--tw-empty,/*!*/ /*!*/);--tw-backdrop-sepia:var(--tw-empty,/*!*/ /*!*/)}.max-h-40{max-height:10rem}.opacity-75{opacity:.75}.opacity-90{opacity:.9}.select-none{user-select:none;-webkit-user-select:none}.pointer-events-none{pointer-events:none}.pointer-events-auto,.slider-handle{pointer-events:auto}.whitespace-nowrap{white-space:nowrap}.break-words{word-wrap:break-word}.break-all{word-break:break-all}.hidden{display:none}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.flex-col{flex-direction:column}.relative{position:relative}.absolute{position:absolute}.inset-0{top:0;right:0;bottom:0;left:0}.top-1\/2{top:50%}.right-4{right:1rem}.w-full{width:100%}.h-12,.w-12{width:3rem}.w-5{width:1.25rem}.h-20{height:5rem}.h-5{height:1.25rem}.h-2{height:.5rem}.max-w-4xl{max-width:56rem}.min-h-screen{min-height:100vh}.transform{transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y:-50%;transform:var(--tw-transform)}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:var(--tw-transform)}.p-8{padding:2rem}.p-4{padding:1rem}.p-3{padding:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pt-8{padding-top:2rem}.pb-20{padding-bottom:5rem}.pr-16{padding-right:4rem}.mt-auto{margin-top:auto}.mt-12{margin-top:3rem}.mt-8{margin-top:2rem}.mt-6,.space-y-6>*+*{margin-top:1.5rem}.mt-2{margin-top:.5rem}.mb-16{margin-bottom:4rem}.mb-8{margin-bottom:2rem}.mb-6{margin-bottom:1.5rem}.mb-4{margin-bottom:1rem}.mb-2{margin-bottom:.5rem}.mr-2{margin-right:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.space-y-4>*+*{margin-top:1rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-base{font-size:1rem;line-height:1.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.font-medium{font-weight:500}.text-center{text-align:center}.text-white{color:#fff}.hover\:text-gray-800:hover,.text-gray-800{color:#1f2937}.text-gray-600{color:#4b5563}.text-gray-500{color:#6b7280}.text-gray-400{color:#9ca3af}.text-blue-600{color:#2563eb}.text-purple-700{color:#6d28d9}.bg-white{background-color:#fff}.bg-blue-50{background-color:#eff6ff}.bg-purple-50{background-color:#f5f3ff}.bg-purple-200{background-color:#ddd6fe}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.from-gray-50{--tw-gradient-from:#f9fafb;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,#f9fafb)}.to-gray-100{--tw-gradient-to:#f3f4f6}.border{border-width:1px}.border-gray-300{border-color:#d1d5db}.rounded-2xl{border-radius:1rem}.rounded-lg{border-radius:.5rem}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.canvas-container,.comparison-slider-wrapper{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);overflow:hidden}.cursor-pointer{cursor:pointer}.cursor-crosshair{cursor:crosshair}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.transition-colors{transition-property:background-color,border-color,color,fill,stroke;transition-duration:.2s}.transition-transform{transition-property:transform;transition-duration:.3s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgba(59,130,246,var(--tw-ring-opacity))}.focus\:border-transparent:focus{border-color:transparent}.items-center{align-items:center}.transition-all{transition:.3s ease-in-out}.custom-file-upload{border:2px dashed #93c5fd;border-radius:.5rem;padding:2rem;text-align:center;cursor:pointer;transition:.3s;background-color:#f0f7ff}.custom-file-upload:hover{border-color:#3b82f6;background-color:#eff6ff}.step-transition{transition:opacity .5s ease-in-out,transform .5s ease-in-out}.step-enter{opacity:0;transform:translateY(20px)}.step-enter-active{opacity:1;transform:translateY(0)}.canvas-container{border-radius:.5rem}.gradient-button{background:linear-gradient(135deg,#2563eb 0,#3b82f6 100%);transition:transform .2s,box-shadow .2s;border:none;cursor:pointer}.gradient-button:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(37,99,235,0.3)}.slider-handle{position:absolute;top:0;bottom:0;left:50%;width:2px;background:#fff;cursor:ew-resize;transform:translateX(-50%)}.slider-handle::before{position:absolute;width:40px;height:40px;border-radius:50%;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.3);content:'';top:50%;left:50%;transform:translate(-50%,-50%)}.slider-handle::after{position:absolute;content:'';width:24px;height:24px;top:50%;left:50%;transform:translate(-50%,-50%);background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234A5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M10 19l-7-7 7-7'/%3E%3Cpath d='M14 19l7-7-7-7'/%3E%3C/svg%3E") center/contain no-repeat}.blur-button{background:linear-gradient(135deg,#f97316 0,#fb923c 100%)}.back-button{background:linear-gradient(135deg,#4b5563 0,#1f2937 100%)}.comparison-slider-wrapper{position:relative;width:100%;max-width:2xl;margin:0 auto;border-radius:.5rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:#fff;aspect-ratio:1.6;overflow:hidden}.comparison-slider-wrapper>img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.comparison-slider{position:absolute;inset:0;width:50%;overflow:hidden;background-color:#fff}.comparison-slider img{position:absolute;top:0;left:0;width:200%;height:100%;object-fit:cover}.slider-handle{position:absolute;top:0;bottom:0;left:50%;width:6px;background:#abc3db;cursor:ew-resize;transform:translateX(-50%)}.slider-handle::before{position:absolute;width:40px;height:40px;border-radius:50%;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.3)}.slider-handle::after{position:absolute;content:'';width:24px;height:24px;top:50%;left:50%;transform:translate(-50%,-50%);background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234A5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M10 19l-7-7 7-7'/%3E%3Cpath d='M14 19l7-7-7-7'/%3E%3C/svg%3E") center/contain no-repeat}a{text-decoration:none}.card{background:rgba(255,255,255,0.9);backdrop-filter:blur(10px);border:1px solid rgba(148,163,184,0.1)}#downloadBtn{background:linear-gradient(135deg,#1d4ed8 0%,#3b82f6 100%)!important}#downloadBtn:hover{box-shadow:0 4px 12px rgba(29,78,216,0.3)}.highlight{background-color:#fff7ed;border-left:4px solid #f97316;padding:1rem;border-radius:.5rem}.faq-question{transition:all .3s ease}.faq-question:hover{transform:translateX(8px)}
    </style>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QHR9LGCNE8"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QHR9LGCNE8');
    </script>
</head>
<body class="flex flex-col items-center pt-8 pb-20">
    <div class="w-full max-w-4xl p-8 card rounded-2xl shadow-xl text-center mb-16">
        <a href="https://datosargentinos.com" title="Safe ID - Comparte tu DNI de Forma Segura - Datos Argentinos"><img src="/logo.png" alt="Safe ID - Comparte tu DNI de Forma Segura - Datos Argentinos" class="mx-auto mb-6 h-20 transform hover:scale-105 transition-transform duration-300"></a>
        <h1 class="text-4xl font-bold mb-8 text-gray-800">Comparte tu DNI de Forma Segura</h1>
        
        <!-- Step 1: Upload and Text -->
        <div id="step1" class="space-y-6 step-transition">
            <label class="custom-file-upload block">
                <input type="file" id="imageInput" accept=".jpg,.jpeg,.png" class="hidden">
                <svg class="w-12 h-12 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                <p class="text-lg text-gray-600">Arrastra tu imagen o toca aquí para subirla</p>
                <p class="text-sm text-gray-500 mt-2">Soporta: JPG y PNG</p>
            </label>
            <div class="relative">
                <div class="relative">
                    <div class="relative">
                        <input type="text" id="watermarkText" maxlength="60" placeholder="Ingresa el texto de la marca de agua (máx. 60 caracteres)" 
                            class="w-full p-4 pr-16 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-center text-lg">
                        <span class="absolute right-4 top-1/2 -translate-y-1/2 text-sm text-gray-500">
                            <span id="charCount">0</span>/60
                        </span>
                    </div>
                    <p class="mt-2 text-sm text-gray-600 bg-blue-50 p-3 rounded-lg">
                        <strong>Tip Marca de Agua:</strong> Para mayor seguridad, incluye el nombre completo del destinatario y el motivo específico (ej: "Para Juan Pérez - Validación de identidad en Banco XYZ")
                    </p>
                </div>
            </div>
            <button id="nextToPreviewBtn" class="w-full gradient-button text-white py-4 rounded-lg text-lg font-semibold hover:opacity-90">
                Siguiente
            </button>
        </div>

        <!-- Step 2: Preview and Blur -->
        <div id="step2" class="hidden step-transition">
            <div class="mb-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Vista Previa y Ofuscación de Datos</h2>
                <div class="canvas-container">
                    <canvas id="originalCanvas" class="w-full cursor-crosshair"></canvas>
                </div>
            </div>
            <div class="space-y-4">
                <button id="enableBlurBtn" class="w-full blur-button gradient-button text-white py-4 rounded-lg text-lg font-semibold">
                    Ofuscar Datos
                </button>
                <div id="blurControls" class="bg-purple-50 p-4 rounded-lg hidden">
                    <label class="block text-sm font-medium text-purple-700 mb-2">
                        Intensidad de Ofuscación: <span id="blurValue">5</span>
                    </label>
                    <input type="range" id="blurIntensity" min="3" max="15" value="5" 
                        class="w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer">
                </div>
                <div id="blurInstructions" class="bg-purple-50 text-purple-700 p-4 rounded-lg" style="display: none;">
                    Haz clic y arrastra para ofuscar áreas sensibles, y luego aplica la marca de agua
                </div>
                <button id="nextToWatermarkBtn" class="w-full gradient-button text-white py-4 rounded-lg text-lg font-semibold">
                    Aplicar Marca de Agua
                </button>
            </div>
        </div>

        <!-- Step 3: Final Result -->
        <div id="step3" class="hidden step-transition">
            <div class="mb-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Resultado Final</h2>
                <div class="canvas-container">
                    <canvas id="canvas" class="w-full"></canvas>
                </div>
            </div>
            <button id="downloadBtn" class="w-full gradient-button text-white py-4 rounded-lg text-lg font-semibold">
                Descargar Imagen
            </button>
            <a href="#" id="startOverBtn" class="block mt-12 text-gray-600 hover:text-gray-800 text-base transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="inline-block w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                Volver a empezar
            </a>
        </div>
    </div>

    <!-- FAQ Section -->
    <div class="w-full max-w-4xl p-8 card rounded-2xl shadow-xl mt-8">
        <h2 class="text-2xl font-semibold text-gray-800 mb-8 text-center">Preguntas Frecuentes</h2>
        <div class="space-y-6">
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Es seguro usar esta herramienta?</h3>
                <p class="highlight">Sí, la marca de agua se procesa localmente en tu navegador. Ninguna imagen se sube a servidores externos, garantizando la privacidad de tus datos.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Por qué debo proteger mi DNI al compartirlo?</h3>
                <p class="text-gray-600">Compartir tu DNI sin protección puede llevar a suplantación de identidad y fraudes. Al agregar una marca de agua y ofuscar datos sensibles, reduces significativamente estos riesgos.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Qué datos debo ofuscar de mi DNI?</h3>
                <p class="text-gray-600">Se recomienda ofuscar el número de trámite, los códigos de barras y QR, y cualquier otro dato que no sea necesario para el propósito específico del trámite.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Qué texto debo usar en la marca de agua?</h3>
                <p class="text-gray-600">Es recomendable incluir el nombre del destinatario y el propósito específico, por ejemplo: "Para Banco XYZ - Validación de identidad - DD/MM/AAAA".</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">Vista Previa</h3>
                <p class="text-gray-600 mt-6">Desliza para ver la diferencia entre la imagen original y el resultado final</p><br />
                    <div class="comparison-slider-wrapper">
                        <img src="/dni-after.png" alt="Imagen con marca de agua">
                        <div class="comparison-slider">
                            <img src="/dni-before.png" alt="Imagen original">
                        </div>
                        <div class="slider-handle"></div>
                    </div>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Las imágenes procesadas son válidas para trámites?</h3>
                <p class="text-gray-600">Sí, siempre que los datos principales (foto, nombre, número de DNI) sean claramente visibles. Consulta con la entidad específica sobre sus requisitos.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Dónde puedo ver el código fuente del proyecto?</h3>
                <p class="text-gray-600">El código es open source y está disponible en <a href="https://github.com/Xyborg/datosargentinos.com" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-gray-800">GitHub</a>. Puedes revisarlo, contribuir o reportar problemas.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Puedo usar la herramienta sin conexión a internet?</h3>
                <p class="text-gray-600">Sí, la herramienta es una PWA (Progressive Web App) que puedes instalar en tu dispositivo. Una vez instalada, funciona completamente sin conexión a internet.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Cómo instalo la aplicación en mi dispositivo?</h3>
                <p class="text-gray-600">En Chrome/Edge de escritorio, haz clic en el ícono de instalación en la barra de direcciones. En dispositivos móviles, selecciona "Agregar a pantalla principal" en el menú del navegador. La app se instalará y podrás acceder directamente desde tu escritorio o pantalla de inicio.</p>
            </div>
            <div class="faq-question">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">¿Qué ventajas tiene instalar la app?</h3>
                <p class="text-gray-600">Al instalar la app, podrás acceder más rápidamente, trabajar sin conexión a internet, y tener una experiencia más fluida similar a una aplicación nativa. Además, ocupará menos espacio en caché que usar la versión web.</p>
            </div>
        </div>
    </div>

    <footer class="w-full py-4 text-center text-gray-600 text-sm mt-auto">
        Desarrollado por <a href="https://www.martinaberastegue.com" class="text-blue-600 hover:text-gray-800" target="_blank" rel="noopener noreferrer">Martin Aberastegue</a>.<br>
        Inspirado en <a href="https://saferlayer.com" class="text-blue-600 hover:text-gray-800" target="_blank" rel="noopener noreferrer">Saferlayer.com</a> y adaptado al caso de uso del DNI Argentino.
    </footer>
    <a href="https://www.iubenda.com/privacy-policy/69980701" class="iubenda-white iubenda-noiframe iubenda-embed iubenda-noiframe" target="_blank" rel="noopener noreferrer" title="Política de Privacidad">Política de Privacidad</a><script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src="https://cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>

    <script>
        /**
         * SAFE ID - Herramienta de Protección de DNI
         * 
         * Esta herramienta procesa las imágenes completamente en el navegador del usuario.
         * No se realiza ninguna carga de imágenes a servidores externos.
         * Todo el procesamiento de imágenes y datos se realiza localmente.
         */

        // Referencias a elementos del DOM para la interfaz de usuario
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const nextToPreviewBtn = document.getElementById('nextToPreviewBtn');
        const nextToWatermarkBtn = document.getElementById('nextToWatermarkBtn');
        const enableBlurBtn = document.getElementById('enableBlurBtn');
        const startOverBtn = document.getElementById('startOverBtn');
        const blurInstructions = document.getElementById('blurInstructions');
        
        /**
         * Configuración de los canvas para el procesamiento de imágenes
         * Se utilizan dos canvas:
         * - originalCanvas: mantiene la imagen original con las áreas ofuscadas
         * - canvas: muestra el resultado final con la marca de agua
         * 
         * willReadFrequently: true -> Optimiza el rendimiento para operaciones frecuentes de lectura de píxeles
         */
        const originalCanvas = document.getElementById('originalCanvas');
        const originalCtx = originalCanvas.getContext('2d', { willReadFrequently: true });
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d', { willReadFrequently: true });
        
        // Variables de estado para el control de la aplicación
        let img = new Image();           // Almacena la imagen cargada
        let painting = false;            // Controla el estado de pintado/ofuscación
        let blurEnabled = false;         // Controla si el modo ofuscación está activo

        /**
         * Configuración de calidad para el procesamiento de imágenes
         * Asegura que las imágenes mantengan la mejor calidad posible durante el procesamiento
         */
        originalCtx.imageSmoothingEnabled = true;
        originalCtx.imageSmoothingQuality = 'high';
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';

        /**
         * Sistema de contador de caracteres para la marca de agua
         * Limita y muestra la cantidad de caracteres ingresados (máximo 60)
         */
        const watermarkInput = document.getElementById('watermarkText');
        const charCount = document.getElementById('charCount');
        
        watermarkInput.addEventListener('input', function() {
            charCount.textContent = this.value.length;
        });

        /**
         * Manejador de carga de imágenes
         * - Valida el tipo de archivo (solo JPG y PNG)
         * - Procesa la imagen localmente sin enviarla a ningún servidor
         * - Muestra una vista previa en la interfaz
         */
        document.getElementById('imageInput').addEventListener('change', function(e) {
            if (e.target.files[0]) {
                const file = e.target.files[0];
                const fileLabel = this.parentElement.querySelector('p');
                
                // Validación de seguridad: solo permite formatos de imagen seguros
                const validTypes = ['image/jpeg', 'image/jpg', 'image/png'];
                if (!validTypes.includes(file.type)) {
                    alert('Por favor sube un archivo en formato JPG o PNG');
                    this.value = ''; // Limpia el input por seguridad
                    return;
                }
                
                fileLabel.textContent = file.name;
                
                // Procesamiento local de la imagen para vista previa
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewImg = document.createElement('img');
                    previewImg.src = e.target.result;
                    previewImg.classList.add('mx-auto', 'mt-4', 'max-h-40', 'rounded-lg');
                    
                    const existingPreview = fileLabel.parentElement.querySelector('img');
                    if (existingPreview) {
                        existingPreview.remove();
                    }
                    
                    fileLabel.parentElement.appendChild(previewImg);
                };
                reader.readAsDataURL(file);
            }
        });

        /**
         * Sistema de transición entre pasos
         * Maneja la visibilidad y animaciones entre las diferentes etapas del proceso
         */
        function showStep(stepToShow) {
            [step1, step2, step3].forEach(step => {
                if (step === stepToShow) {
                    step.classList.remove('hidden');
                    step.classList.add('step-enter');
                    setTimeout(() => step.classList.add('step-enter-active'), 10);
                } else {
                    step.classList.add('hidden');
                    step.classList.remove('step-enter', 'step-enter-active');
                }
            });
        }

        /**
         * Cargador de imágenes seguro
         * - Procesa la imagen manteniendo las dimensiones originales
         * - No reduce la calidad de la imagen
         * - Mantiene todo el procesamiento en el dispositivo del usuario
         */
        function loadImage(file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                img = new Image();
                img.onload = function () {
                    // Mantiene las dimensiones originales para no perder calidad
                    originalCanvas.width = canvas.width = img.width;
                    originalCanvas.height = canvas.height = img.height;
                    originalCtx.drawImage(img, 0, 0, img.width, img.height);
                    ctx.drawImage(img, 0, 0, img.width, img.height);
                    
                    // Ajusta el tamaño visual manteniendo la proporción
                    originalCanvas.style.width = canvas.style.width = '100%';
                    originalCanvas.style.height = canvas.style.height = 'auto';
                    originalCanvas.style.maxWidth = canvas.style.maxWidth = '100%';
                };
                img.onerror = function() {
                    alert('Error al cargar la imagen. Por favor intenta con otro archivo.');
                };
                img.src = e.target.result;
            };
            reader.onerror = function() {
                alert('Error al leer el archivo. Por favor intenta de nuevo.');
            };
            reader.readAsDataURL(file);
        }

        /**
         * Validación y procesamiento del paso inicial
         * Verifica que se hayan proporcionado todos los datos necesarios
         */
        nextToPreviewBtn.addEventListener('click', () => {
            const imageInput = document.getElementById('imageInput');
            const watermarkText = watermarkInput.value;
            
            if (!imageInput.files[0]) {
                alert('Por favor sube una imagen primero.');
                return;
            }
            if (!watermarkText.trim()) {
                alert('Por favor ingresa el texto de la marca de agua.');
                return;
            }
            if (watermarkText.length > 60) {
                alert('El texto de la marca de agua debe ser de 60 caracteres o menos.');
                return;
            }

            loadImage(imageInput.files[0]);
            showStep(step2);
        });

        /**
         * Sistema de control de ofuscación
         * Permite al usuario ajustar la intensidad del efecto de blur
         */
        const blurIntensity = document.getElementById('blurIntensity');
        const blurValue = document.getElementById('blurValue');
        const blurControls = document.getElementById('blurControls');

        blurIntensity.addEventListener('input', function() {
            blurValue.textContent = this.value;
        });

        /**
         * Control del modo ofuscación
         * Activa/desactiva la capacidad de ofuscar áreas sensibles
         */
        enableBlurBtn.addEventListener('click', () => {
            blurEnabled = !blurEnabled;
            blurInstructions.style.display = blurEnabled ? 'block' : 'none';
            blurControls.classList.toggle('hidden');
            enableBlurBtn.textContent = blurEnabled ? 'Desactivar Modo Ofuscación' : 'Ofuscar Datos';
            enableBlurBtn.classList.toggle('opacity-75');
            
            if (blurEnabled && 'ontouchstart' in window) {
                blurInstructions.textContent = 'Toca y arrastra para ofuscar áreas sensibles, luego aplica la marca de agua';
            }
        });

        // Navegación entre pasos
        nextToWatermarkBtn.addEventListener('click', () => {
            showStep(step3);
            applyWatermark();
        });

        startOverBtn.addEventListener('click', () => {
            location.reload();
        });

        /**
         * Sistema de descarga segura
         * Genera la imagen final en el dispositivo del usuario
         * No se realiza ninguna carga a servidores externos
         */
        document.getElementById('downloadBtn').addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'safeid_datosargentinoscom.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        });

        /**
         * Sistema de ofuscación interactivo
         * Maneja eventos de mouse y touch para permitir al usuario
         * ofuscar áreas específicas de la imagen
         */
        originalCanvas.addEventListener('mousedown', (event) => {
            if (blurEnabled) {
                painting = true;
                blurAtMouse(event);
            }
        });
        
        originalCanvas.addEventListener('mouseup', () => painting = false);
        originalCanvas.addEventListener('mousemove', (event) => {
            if (painting && blurEnabled) {
                blurAtMouse(event);
            }
        });

        // Soporte para dispositivos táctiles
        originalCanvas.addEventListener('touchstart', (event) => {
            if (blurEnabled) {
                event.preventDefault();
                painting = true;
                blurAtTouch(event);
            }
        });

        originalCanvas.addEventListener('touchend', (event) => {
            event.preventDefault();
            painting = false;
        });

        originalCanvas.addEventListener('touchmove', (event) => {
            if (painting && blurEnabled) {
                event.preventDefault();
                blurAtTouch(event);
            }
        });

        /**
         * Funciones de cálculo de posición para ofuscación
         * Convierten las coordenadas de pantalla a coordenadas de imagen
         * considerando el escalado y posición del canvas
         */
        function blurAtMouse(event) {
            const rect = originalCanvas.getBoundingClientRect();
            const scaleX = originalCanvas.width / rect.width;
            const scaleY = originalCanvas.height / rect.height;
            const x = (event.clientX - rect.left) * scaleX;
            const y = (event.clientY - rect.top) * scaleY;
            applyBlur(x, y);
        }

        function blurAtTouch(event) {
            const rect = originalCanvas.getBoundingClientRect();
            const scaleX = originalCanvas.width / rect.width;
            const scaleY = originalCanvas.height / rect.height;
            const touch = event.touches[0];
            const x = (touch.clientX - rect.left) * scaleX;
            const y = (touch.clientY - rect.top) * scaleY;
            applyBlur(x, y);
        }

        /**
         * Algoritmo de ofuscación
         * Implementa un efecto de blur gaussiano para proteger información sensible
         * El proceso es irreversible y se realiza localmente
         */
        function applyBlur(x, y) {
            const radius = 10;
            const diameter = radius * 2;
            const imageData = originalCtx.getImageData(x - radius, y - radius, diameter, diameter);
            const pixels = imageData.data;
            const centerX = radius;
            const centerY = radius;
            
            for (let i = 0; i < diameter; i++) {
                for (let j = 0; j < diameter; j++) {
                    const idx = (i * diameter + j) * 4;
                    const distance = Math.sqrt(Math.pow(i - centerX, 2) + Math.pow(j - centerY, 2));
                    
                    if (distance <= radius) {
                        const neighbors = getNeighborPixels(pixels, i, j, diameter);
                        pixels[idx] = neighbors.r;
                        pixels[idx + 1] = neighbors.g;
                        pixels[idx + 2] = neighbors.b;
                    }
                }
            }
            
            originalCtx.putImageData(imageData, x - radius, y - radius);
        }

        /**
         * Función auxiliar para el cálculo de blur
         * Promedia los píxeles vecinos para crear el efecto de desenfoque
         */
        function getNeighborPixels(pixels, x, y, diameter) {
            const intensity = parseInt(blurIntensity.value);
            const neighbors = {
                r: 0,
                g: 0,
                b: 0,
                count: 0
            };

            for (let i = -intensity; i <= intensity; i++) {
                for (let j = -intensity; j <= intensity; j++) {
                    const newX = x + i;
                    const newY = y + j;
                    
                    if (newX >= 0 && newX < diameter && newY >= 0 && newY < diameter) {
                        const neighborIdx = (newX * diameter + newY) * 4;
                        neighbors.r += pixels[neighborIdx];
                        neighbors.g += pixels[neighborIdx + 1];
                        neighbors.b += pixels[neighborIdx + 2];
                        neighbors.count++;
                    }
                }
            }

            return {
                r: neighbors.r / neighbors.count,
                g: neighbors.g / neighbors.count,
                b: neighbors.b / neighbors.count
            };
        }

        /**
         * Sistema de marca de agua
         * Aplica una marca de agua visible y persistente a la imagen
         * El proceso es irreversible y se realiza en múltiples capas
         * para prevenir la eliminación de la marca de agua
         */
        function applyWatermark() {
            const watermarkText = watermarkInput.value;
            ctx.drawImage(originalCanvas, 0, 0);
            
            // Convierte la imagen a escala de grises para mejor contraste con la marca de agua
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            for (let i = 0; i < data.length; i += 4) {
                const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                data[i] = data[i + 1] = data[i + 2] = avg;
            }
            ctx.putImageData(imageData, 0, 0);

            // Calcula el tamaño de fuente proporcional a la imagen
            const minFontSize = 16;
            const maxFontSize = 32;
            const baseFontSize = Math.min(canvas.width, canvas.height) / 30;
            const fontSize = Math.min(maxFontSize, Math.max(minFontSize, baseFontSize));
            
            ctx.font = `${fontSize}px Arial`;
            ctx.textAlign = 'center';
            
            // Calcula el espaciado para la repetición de la marca de agua
            const textWidth = ctx.measureText(watermarkText).width;
            const horizontalSpacing = textWidth * 1.2;
            const verticalSpacing = fontSize * 1.2;

            // Configura la transformación para el patrón diagonal
            ctx.save();
            ctx.translate(canvas.width/2, canvas.height/2);
            ctx.rotate(-Math.PI / 6);
            ctx.translate(-canvas.width/2, -canvas.height/2);

            // Calcula el área de cobertura para la marca de agua
            const diagonal = Math.sqrt(canvas.width * canvas.width + canvas.height * canvas.height);
            const startX = -diagonal/2;
            const startY = -diagonal/2;
            const endX = diagonal * 1.5;
            const endY = diagonal * 1.5;

            /**
             * Función para crear el efecto ondulado en el texto
             * Añade variación y complejidad a la marca de agua
             * para dificultar su eliminación
             */
            const drawWavyText = (text, x, y, amplitude, frequency) => {
                const characters = text.split('');
                let currentX = x - (textWidth / 2);
                const baselineY = y;
                
                characters.forEach((char) => {
                    const charWidth = ctx.measureText(char).width;
                    const waveX = currentX + (charWidth / 2);
                    const yOffset = amplitude * Math.sin(frequency * waveX + baselineY * 0.05);
                    const xOffset = amplitude * 0.3 * Math.cos(frequency * waveX + baselineY * 0.05);
                    
                    // Capa de sombra para mejorar legibilidad
                    ctx.globalAlpha = 0.1;
                    ctx.fillText(char, currentX + xOffset + 1, baselineY + yOffset + 1);
                    
                    // Capa principal del texto
                    ctx.globalAlpha = 0.35;
                    ctx.fillText(char, currentX + xOffset, baselineY + yOffset);
                    
                    currentX += charWidth * 1.1;
                });
            };

            // Paleta de colores para la marca de agua
            const colors = [
                'rgba(230, 110, 110, 0.7)',  // Rojo claro
                'rgba(140, 171, 111, 0.7)',  // Verde oliva
                'rgba(124, 128, 194, 0.7)',  // Azul grisáceo
                'rgba(186, 85, 211, 0.7)',   // Púrpura
                'rgba(255, 165, 0, 0.7)',    // Naranja
                'rgba(75, 0, 130, 0.7)',     // Índigo
                'rgba(64, 224, 208, 0.7)',   // Turquesa
                'rgba(255, 20, 147, 0.7)',   // Rosa intenso
                'rgba(255, 215, 0, 0.7)',    // Dorado
                'rgba(0, 128, 128, 0.7)',    // Verde azulado
                'rgba(219, 112, 147, 0.7)',  // Rosa pálido
                'rgba(106, 90, 205, 0.7)',   // Azul pizarra
                'rgba(255, 99, 71, 0.7)',    // Tomate
                'rgba(147, 112, 219, 0.7)',  // Púrpura medio
                'rgba(60, 179, 113, 0.7)',   // Verde mar medio
                'rgba(238, 130, 238, 0.7)',  // Violeta
                'rgba(218, 165, 32, 0.7)',   // Dorado oscuro
                'rgba(72, 209, 204, 0.7)',   // Turquesa medio
                'rgba(199, 21, 133, 0.7)',   // Magenta medio
                'rgba(255, 140, 0, 0.7)'     // Naranja oscuro
            ];

            // Aplica el patrón de marca de agua en toda la imagen
            for (let y = startY; y < endY; y += verticalSpacing) {
                let offsetX = (Math.floor(y / verticalSpacing) % 2) * (horizontalSpacing / 2);
                
                for (let x = startX + offsetX; x < endX; x += horizontalSpacing) {
                    const amplitude = fontSize * 0.3;
                    const frequency = 0.02;
                    ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)];
                    drawWavyText(watermarkText, x, y, amplitude, frequency);
                }
            }

            ctx.restore();
            ctx.globalAlpha = 1;
        }

        /**
         * Sistema de comparación visual
         * Permite al usuario comparar la imagen original con la versión protegida
         * mediante un control deslizante interactivo
         */
        const comparisonSlider = document.querySelector('.comparison-slider');
        const sliderHandle = document.querySelector('.slider-handle');
        let isSliderDragging = false;

        function updateSliderPosition(x) {
            const rect = comparisonSlider.parentElement.getBoundingClientRect();
            const position = Math.max(0, Math.min(x - rect.left, rect.width));
            const percentage = (position / rect.width) * 100;
            
            comparisonSlider.style.width = `${percentage}%`;
            sliderHandle.style.left = `${percentage}%`;
            
            const originalImg = comparisonSlider.querySelector('img');
            originalImg.style.width = `${(100 / percentage) * 100}%`;
            originalImg.style.maxWidth = 'none';
        }

        // Eventos para el control deslizante
        sliderHandle.addEventListener('mousedown', () => isSliderDragging = true);
        document.addEventListener('mousemove', (e) => {
            if (isSliderDragging) updateSliderPosition(e.clientX);
        });
        document.addEventListener('mouseup', () => isSliderDragging = false);

        // Soporte táctil para el control deslizante
        sliderHandle.addEventListener('touchstart', () => isSliderDragging = true);
        document.addEventListener('touchmove', (e) => {
            if (isSliderDragging) updateSliderPosition(e.touches[0].clientX);
        });
        document.addEventListener('touchend', () => isSliderDragging = false);

        // Registro del Service Worker. Esto nos permite que la herramienta funcione offline como PWA.
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registrado con éxito:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Error al registrar el Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
